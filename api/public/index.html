<!doctype html>
<html lang="en">

<head>
    <!-- Meta -->
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">

    <!-- favicon -->
    <link rel="icon" sizes="16x16" href="assets/img/favicon.png">

    <!-- Title -->
    <title>Gestion des blogs </title>

    <!-- Font Google -->
    <link href="https://fonts.googleapis.com/css?family=Muli:300,400,500,600,700,800,900&display=swap" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.13.0/css/all.min.css" rel="stylesheet">

    <!-- CSS Plugins -->
    <link rel="stylesheet" href="assets/css/all.css">
    <link rel="stylesheet" href="assets/css/elegant-font-icons.css">
    <link rel="stylesheet" href="assets/css/bootstrap.min.css">
    <link rel="stylesheet" href="assets/css/owl.carousel.css">
    <!-- main style -->
    <link rel="stylesheet" href="assets/css/style.css">
    <link rel="stylesheet" href="assets/css/custom.css">
</head>

<body>
    <!--loading -->
    <div class="loading">
        <div class="circle"></div>
    </div>
    <!--/-->

    <!-- Navigation-->
    <nav class="navbar navbar-expand-lg fixed-top">
        <div class="container-fluid">
            <!--logo-->
            <div class="logo">
                <a href="index.html">
                    <img src="images/logo.png" alt="" class="logo-dark">
                    <img src="images/logo.png" alt="" class="logo-white">
                </a>
            </div>
            <!--/-->

            <!--navbar-collapse-->
            <div class="collapse navbar-collapse" id="main_nav">
                <ul class="navbar-nav ml-auto mr-auto">
                    <li class="nav-item">
                        <a class="nav-link nav-login" onclick="forLogin()"> Login </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link nav-register" onclick="forRegister()"> register </a>
                    </li>

                </ul>
            </div>
            <!--/-->

            <!--navbar-right-->
            <div class="navbar-right ml-auto">
                <div class="theme-switch-wrapper">
                    <label class="theme-switch" for="checkbox">
                        <input type="checkbox" id="checkbox" />
                        <div class="slider round"></div>
                    </label>
                </div>
                <div class="social-icones">
                    <ul class="list-inline">
                        <li>
                            <a href="#">
                                <i class="fab fa-facebook-f"></i>
                            </a>
                        </li>
                        <li>
                            <a href="#">
                                <i class="fab fa-instagram"></i>
                            </a>
                        </li>
                        <li>
                            <a href="#">
                                <i class="fab fa-twitter"></i>
                            </a>
                        </li>
                        <li>
                            <a href="#">
                                <i class="fab fa-youtube"></i>
                            </a>
                        </li>
                    </ul>
                </div>


            </div>
        </div>
    </nav>
    <!--/-->


    <!--grid-layout-->
    <section class="section pt-85">
        <div class="container-fluid cntn">
            <div class="row articles">


                <div class="template" style="display: none">
                    <!--<div class="col-lg-4 col-md-6">-->
                    <!--Post-1-->
                    <div class="post-card">
                        <div class="post-card-image">
                            <a href="post-default.html">
                                <img id="img" src=".." alt="">
                            </a>
                        </div>
                        <div class="post-card-content">
                            <span class="categorie cat">Livestyle</span>
                            <h5>
                                <a href="post-default.html" class="title">How to Choose Outfits for Work for woman and men</a>
                            </h5>
                            <p class="content"> Lorem ipsum dolor sit amet consectetur adipisicing elit. Odit quam atque ipsa laborum sunt distinctio...
                            </p>
                            <div class="post-card-info">
                                <ul class="list-inline">
                                    <li>
                                        <a href="author.html">
                                            <img src="assets/img/author/1.jpg" alt="">
                                        </a>
                                    </li>
                                    <li>
                                        <a href="author.html">David Smith</a>
                                    </li>
                                    <li class="dot"></li>
                                    <li>January 15, 2021</li>
                                </ul>
                            </div>
                        </div>
                        <!--</div>
                        /-->
                    </div>
                </div>


            </div>
        </div>
    </section>
    <!--/-->

    <div class="templateLogin" style="display: none">
        <div class="post-card w-70" style="text-align: center;justify-content: center;justify-items: center; margin: auto;">
            <h3>LOGIN</h3>
            <div class="post-card-content ">
                <form>
                    <div class="row">
                        <div class="col-md-12 m-3">
                            <div class="form-group">
                                <input type="email" class="form-control" placeholder="Your email" id="email">
                            </div>
                        </div>
                        <div class="col-md-12">
                            <div class="form-group">
                                <input type="password" class="form-control" placeholder="Your password" id="password">
                            </div>
                        </div>
                    </div>

                    <div class="row">
                        <div style="text-align: center" class="col-md-12 m-3">
                            <div class="form-group">
                                <button onclick="login()" class="btn btn-primary btn-round log" type="button">Log In
                                    </button>
                            </div>
                        </div>
                    </div>
                </form>

            </div>
        </div>
    </div>
    <!--newslettre-->
    <section class="newslettre">
        <div class="container-fluid">
            <div class="newslettre-width text-center">
                <div class="newslettre-info">
                    <h5>Subscribe to our Newslatter</h5>
                    <p> Sign up for free and be the first to get notified about new posts. </p>
                </div>
                <form action="#" class="newslettre-form">
                    <div class="form-flex">
                        <div class="form-group">
                            <input type="email" class="form-control" placeholder="Your email adress" required="required">
                        </div>
                        <button class="submit-btn" type="submit">Subscribe</button>
                    </div>
                </form>
                <div class="social-icones">
                    <ul class="list-inline">
                        <li>
                            <a href="#">
                                <i class="fab fa-facebook-f"></i>Facebook</a>
                        </li>
                        <li>
                            <a href="#">
                                <i class="fab fa-twitter"></i>Twitter </a>
                        </li>
                        <li>
                            <a href="#">
                                <i class="fab fa-instagram"></i>Instagram </a>
                        </li>
                        <li>
                            <a href="#">
                                <i class="fab fa-youtube"></i>Youtube</a>
                        </li>
                    </ul>
                </div>
            </div>
        </div>
    </section>
    <!--footer-->
    <footer class="footer">
        <div class="container-fluid">
            <div class="row">
                <div class="col-lg-12">
                    <div class="copyright">
                        <p>Â© Copyright 2021
                            <a href="#">AssiaGroupe</a>, All rights reserved.</p>
                    </div>
                    <div class="back">
                        <a href="#" class="back-top">
                            <i class="arrow_up"></i>
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </footer>

    <!--Search-form-->
    <div class="search">
        <div class="container-fluid">
            <div class="search-width  text-center">
                <button type="button" class="close">
                    <i class="icon_close"></i>
                </button>
                <form class="search-form" action="#">
                    <input type="search" value="" placeholder="What are you looking for?">
                    <button type="submit" class="search-btn">search</button>
                </form>
            </div>
        </div>
    </div>
    <!--/-->



    <!-- jQuery first, then Popper.js, then Bootstrap JS -->
    <script src="assets/js/jquery.js"></script>
    <script src="assets/js/popper.min.js"></script>
    <script src="assets/js/bootstrap.min.js"></script>

    <!-- JS Plugins  -->
    <script src="assets/js/ajax-contact.js"></script>
    <script src="assets/js/owl.carousel.min.js"></script>
    <script src="assets/js/switch.js"></script>
    <script src="//cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-cookie/1.4.1/jquery.cookie.min.js"></script>
    <!-- JS main  -->
    <script src="assets/js/main.js"></script>
    <script>
        const url = "http://localhost:3000/article?skip=0&take=10";

        $articlesContainer = $(".cntn > .articles");
        //$loginLayouts = $(".login-layout ");

        function show(data) {
            const $card = $(".template > .post-card ");
            data.forEach((e) => {
                const $col = $('<div class = "col-lg-4 col-md-6 articlesDiv"></div>');
                const $clone = $card.clone(true);
                const src = $("img", $clone).attr("src");
                $("#img", $clone).attr('src', e.image + '?' + e.id)
                $(".title", $clone).text(e.title);
                $(".content", $clone).text(e.content);
                $(".cat", $clone).text(e.categorId);
                $col.append($clone).appendTo($articlesContainer);
            });
        }
        $.getJSON(url).then(show);
        // login
        function forLogin() {
            const $card = $(".templateLogin > .post-card ");
            $(".articlesDiv").attr('style', "display:none")
            $(".nav-login").attr('style', "display:none")
            const $col = $('<div class = ""></div>');
            const $clone = $card.clone(true);
            console.log('hi')
            $col.append($clone).appendTo($articlesContainer);

        }

        function login() {

            $email = $('#email')
            $pass = $('#password')

            $(document).ready(function() {
                $(".log").click(function(e) {
                    e.preventDefault();
                    $.ajax({
                        type: "POST",
                        url: "/login",
                        data: {
                            email: $email.val(),
                            passwrd: $pass.val()
                        },
                        success: function(result) {

                            let role = result.role;
                            //let token = result.token;
                            let token = 11;
                            let id = result.id;
                            $.cookie('token', token);
                            $.cookie('role', role);
                            $.cookie('id', id);
                            if (role === 'ADMIN') {
                                alert('hi')
                                    // window.location.replace("index.html");
                            } else if (role === 'AUTHOR') {
                                alert('ho')
                                    // window.location.href = "create.html";
                            } else {
                                alert('ha')
                                    // window.location.href = "index.html";
                            }
                        },
                        error: function(result) {
                            Swal.fire({
                                position: 'center',
                                icon: 'error',
                                title: "Something went wrong!",
                                showConfirmButton: false,
                                timer: 2000
                            })
                            console.log(result)
                        }
                    });
                });
            });
        }
        //register
        function forRegister() {

        }
    </script>

</body>

</html>